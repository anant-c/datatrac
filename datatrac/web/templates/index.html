<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DataTrac - Dataset Registry</title>
  
  <!-- Global shared styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/global.css') }}" />
  
  <!-- Page-specific styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}" />

</head>
<body>
  <header>
    <h1>DataTrac Dataset Registry</h1>
  </header>

  <section id="upload-section">
    <h2>Upload New Dataset</h2>
    <form action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data">
      <input type="file" name="file" required />
      <input type="text" name="source" placeholder="Source URL (optional)" />
      <input type="text" name="local_path" placeholder="Local path (optional)" />
      <button type="submit">Upload</button>
    </form>

  </section>

  <section id="datasets-list">
  <h2>Registered Datasets</h2>
  {% if datasets %}
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Hash</th>
        <th>Source</th>
        <th>Created At</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for ds in datasets %}
      <tr>
        <td>
          {{ ds.name }} <br>
          {% if ds.size_bytes %}
            {{ ds.size_bytes | sizeof_fmt }}
          {% else %}
            N/A
          {% endif %}
        </td>
        <td>{{ ds.hash }}</td>
        <td>{{ ds.source or 'N/A' }}</td>
        <td>{{ ds.created_at.strftime("%b %d, %Y %I:%M %p") }}</td>
        <td>
          <a href="{{ url_for('details', file_hash=ds.hash) }}" class="button-link view-btn">View</a>
          <a href="{{ url_for('lineage', file_hash=ds.hash) }}" class="button-link lineage-btn">Lineage</a>
          <a href="{{ url_for('download', file_hash=ds.hash) }}" class="button-link download-btn">Download</a>
          <form action="{{ url_for('delete', file_hash=ds.hash) }}" method="post" style="display:inline" onsubmit="return confirm('Are you sure you want to delete this dataset?');">
            <button type="submit" class="danger">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No datasets found.</p>
  {% endif %}
</section>

  
</body>
</html>
